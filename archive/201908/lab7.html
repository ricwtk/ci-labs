<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lab 7: Fuzzy Systems | CSC3034</title>
    <meta name="description" content="">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@3.x/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css">
    
    <link rel="preload" href="/ci-labs/assets/css/0.styles.4805b9ce.css" as="style"><link rel="preload" href="/ci-labs/assets/js/app.5a6eedcf.js" as="script"><link rel="preload" href="/ci-labs/assets/js/2.f123190f.js" as="script"><link rel="preload" href="/ci-labs/assets/js/12.81161026.js" as="script"><link rel="prefetch" href="/ci-labs/assets/js/10.50dc5fb0.js"><link rel="prefetch" href="/ci-labs/assets/js/11.863e2ba8.js"><link rel="prefetch" href="/ci-labs/assets/js/13.102b3e19.js"><link rel="prefetch" href="/ci-labs/assets/js/14.efc50b54.js"><link rel="prefetch" href="/ci-labs/assets/js/15.2824edf8.js"><link rel="prefetch" href="/ci-labs/assets/js/16.68ceabb0.js"><link rel="prefetch" href="/ci-labs/assets/js/17.98066496.js"><link rel="prefetch" href="/ci-labs/assets/js/18.fc2e5142.js"><link rel="prefetch" href="/ci-labs/assets/js/19.4ebcbc07.js"><link rel="prefetch" href="/ci-labs/assets/js/20.bff1f24a.js"><link rel="prefetch" href="/ci-labs/assets/js/3.74c77c24.js"><link rel="prefetch" href="/ci-labs/assets/js/4.eb099dc3.js"><link rel="prefetch" href="/ci-labs/assets/js/5.a1960905.js"><link rel="prefetch" href="/ci-labs/assets/js/6.6b928bc4.js"><link rel="prefetch" href="/ci-labs/assets/js/7.8290c013.js"><link rel="prefetch" href="/ci-labs/assets/js/8.9d9f317a.js"><link rel="prefetch" href="/ci-labs/assets/js/9.682d5eaf.js">
    <link rel="stylesheet" href="/ci-labs/assets/css/0.styles.4805b9ce.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ci-labs/" class="home-link router-link-active"><!----> <span class="site-name">CSC3034</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://ricwtk.github.io/ai-labs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/ci-labs/" class="nav-link">CI</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://ricwtk.github.io/ai-labs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/ci-labs/" class="nav-link">CI</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/ci-labs/" class="sidebar-link">Home</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2020 August</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ci-labs/lab1.html" class="sidebar-link">Lab 1: Pre-lab</a></li><li><a href="/ci-labs/lab2.html" class="sidebar-link">Lab 2: EC (GA)</a></li><li><a href="/ci-labs/lab3.html" class="sidebar-link">Lab 3: EC (PSO)</a></li><li><a href="/ci-labs/lab4.html" class="sidebar-link">Lab 4: EC (ACO)</a></li><li><a href="/ci-labs/lab5.html" class="sidebar-link">Lab 5: ANN (Supervised learning)</a></li><li><a href="/ci-labs/lab6.html" class="sidebar-link">Lab 6: ANN (Hyperplane)</a></li><li><a href="/ci-labs/lab7.html" class="sidebar-link">Lab 7: Fuzzy Systems</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Archive</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="lab-7-fuzzy-systems"><a href="#lab-7-fuzzy-systems" aria-hidden="true" class="header-anchor">#</a> Lab 7: Fuzzy Systems</h1> <h2 id="fuzzy-systems"><a href="#fuzzy-systems" aria-hidden="true" class="header-anchor">#</a> Fuzzy Systems</h2> <h3 id="objective"><a href="#objective" aria-hidden="true" class="header-anchor">#</a> Objective</h3> <ul><li>to construct a Mamdani fuzzy system using the <code>scikit-fuzzy</code> Python library</li> <li>to evaluate the result of the constructed fuzzy system</li></ul> <h3 id="note"><a href="#note" aria-hidden="true" class="header-anchor">#</a> Note</h3> <p>As of 3<sup>rd</sup> Nov 2019, the <code>scikit-fuzzy</code> Python library only work properly with Python 3.7 and <code>networkx</code> Python library of version 2.3. <code>networkx</code> version 2.4 is not supported yet.</p> <div style="margin-top:20px;"></div> <p>To create a separate environment in Anaconda for <code>scikit-fuzzy</code> library, run the following code in the Anaconda prompt.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>conda create <span class="token operator">-</span>n fuzzy python<span class="token operator">=</span><span class="token number">3.7</span> networkx<span class="token operator">=</span><span class="token number">2.3</span> spyder
conda activate fuzzy
conda install <span class="token operator">-</span>c conda<span class="token operator">-</span>forge scikit<span class="token operator">-</span>fuzzy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Launch Spyder IDE using the command <code>spyder</code>.</p> <h3 id="fuzzy-control-system-for-a-train"><a href="#fuzzy-control-system-for-a-train" aria-hidden="true" class="header-anchor">#</a> Fuzzy control system for a train</h3> <ol><li><p>Consider a fuzzy control system to control the <strong>brake</strong> and <strong>throttle</strong> of a train based on the <strong>speed</strong> of the train and the <strong>distance</strong> of the train to the next stop.</p></li> <li><p>Import the <code>skfuzzy</code>, <code>skfuzzy.control</code>, and <code>numpy</code>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> skfuzzy <span class="token keyword">import</span> control <span class="token keyword">as</span> ctrl
<span class="token keyword">from</span> skfuzzy <span class="token keyword">import</span> membership <span class="token keyword">as</span> mf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol> <h4 id="initialise-inputs-and-outputs"><a href="#initialise-inputs-and-outputs" aria-hidden="true" class="header-anchor">#</a> Initialise inputs and outputs</h4> <ol><li><p>Speed and distance are the inputs of the system whereas brake and throttle are the outputs.</p></li> <li><p>The ranges for the variables are:</p> <table><thead><tr><th style="text-align:left;">Variable</th> <th style="text-align:center;">Range</th></tr></thead> <tbody><tr><td style="text-align:left;">Speed</td> <td style="text-align:center;">0 - 85 km/h</td></tr> <tr><td style="text-align:left;">Distance</td> <td style="text-align:center;">0 - 3000 m</td></tr> <tr><td style="text-align:left;">Brake</td> <td style="text-align:center;">0 - 100%</td></tr> <tr><td style="text-align:left;">Throttle</td> <td style="text-align:center;">0 - 100%</td></tr></tbody></table></li> <li><p>As the inputs will be the antecedents of the rules, construct the variables <code>speed</code> and <code>distance</code> as <code>skfuzzy.control.Antecedent</code> objects.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>speed <span class="token operator">=</span> ctrl<span class="token punctuation">.</span>Antecedent<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'speed'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>The initialisation function for <code>skfuzzy.control.Antecedent</code> object takes 2 arguments, the first is the <em>universe</em> of the variable, i.e. the values the variables can take, the second is the label of the variable. The initialisation function for <code>skfuzzy.control.Consequent</code> is similar.</p></li> <li><p>The label and the range of the variable can be accessed using <code>.label</code> and <code>.universe</code> respectively.</p></li></ol> <div style="margin-top:20px;"></div> <p><strong>Task</strong>: Initialise the variables <code>distance</code> as <code>Antecedent</code> object, and <code>brake</code> and <code>throttle</code> as <code>Consequent</code> objects. (Outputs of the system will be consequents of the rules)</p> <h4 id="define-membership-functions-for-fuzzy-sets-of-variables"><a href="#define-membership-functions-for-fuzzy-sets-of-variables" aria-hidden="true" class="header-anchor">#</a> Define membership functions for fuzzy sets of variables</h4> <ol><li><p>The fit vectors of the fuzzy sets for the linguistic variables are given as follows:</p> <ul><li><p>speed (0 to 85 km/h)</p> <table><thead><tr><th>Linguistic value</th> <th>Fit vector</th></tr></thead> <tbody><tr><td>Stopped</td> <td>(1/0, 0/2)</td></tr> <tr><td>Very slow</td> <td>(0/1, 1/2.5, 0/4)</td></tr> <tr><td>Slow</td> <td>(0/2.5, 1/6.5, 0/10.5)</td></tr> <tr><td>Medium fast</td> <td>(0/6.5, 1/26.5, 0/46.5)</td></tr> <tr><td>Fast</td> <td>(0/26.5, 1/70, 1/85)</td></tr></tbody></table></li> <li><p>distance (0 to 3000 m)</p> <table><thead><tr><th>Linguistic value</th> <th>Fit vector</th></tr></thead> <tbody><tr><td>At</td> <td>(1/0, 0/2)</td></tr> <tr><td>Very near</td> <td>(0/1, 1/3, 0/5)</td></tr> <tr><td>Near</td> <td>(0/3, 1/101.5, 0/200)</td></tr> <tr><td>Medium far</td> <td>(0/100, 1/1550, 0/3000)</td></tr> <tr><td>Far</td> <td>(0/1500, 1/2250, 1/3000)</td></tr></tbody></table></li> <li><p>brake (0 to 100%)</p> <table><thead><tr><th>Linguistic value</th> <th>Fit vector</th></tr></thead> <tbody><tr><td>No</td> <td>(1/0, 0/40)</td></tr> <tr><td>Very slight</td> <td>(0/20, 1/50, 0/80)</td></tr> <tr><td>Slight</td> <td>(0/70, 1/83.5, 0/97)</td></tr> <tr><td>Medium</td> <td>(0/95, 1/97, 0/99)</td></tr> <tr><td>Full</td> <td>(0/98, 1/100)</td></tr></tbody></table></li> <li><p>throttle (0 to 100%)</p> <table><thead><tr><th>Linguistic value</th> <th>Fit vector</th></tr></thead> <tbody><tr><td>No</td> <td>(1/0, 0/2)</td></tr> <tr><td>Very slight</td> <td>(0/1, 1/3, 0/5)</td></tr> <tr><td>Slight</td> <td>(0/3, 1/16.5, 0/30)</td></tr> <tr><td>Medium</td> <td>(0/20, 1/50, 0/80)</td></tr> <tr><td>Full</td> <td>(0/60, 1/80, 1/100)</td></tr></tbody></table></li></ul></li> <li><p>The <code>skfuzzy.membership</code> module provides the following membership functions:</p> <table><thead><tr><th>Membership function</th> <th>Description</th></tr></thead> <tbody><tr><td><code>skfuzzy.membership.dsigmf(x, b1, c1, b2, c2)</code></td> <td>Difference of two fuzzy sigmoid membership functions</td></tr> <tr><td><code>skfuzzy.membership.gauss2mf(x, mean1, ...)</code></td> <td>Gaussian fuzzy membership function of two combined Gaussians</td></tr> <tr><td><code>skfuzzy.membership.gaussmf(x, mean, sigma)</code></td> <td>Gaussian fuzzy membership function</td></tr> <tr><td><code>skfuzzy.membership.gbellmf(x, a, b, c)</code></td> <td>Generalized Bell function fuzzy membership generator</td></tr> <tr><td><code>skfuzzy.membership.piecemf(x, abc)</code></td> <td>Piecewise linear membership function (particularly used in FIRE filters)</td></tr> <tr><td><code>skfuzzy.membership.pimf(x, a, b, c, d)</code></td> <td>Pi-function fuzzy membership generator</td></tr> <tr><td><code>skfuzzy.membership.psigmf(x, b1, c1, b2, c2)</code></td> <td>Product of two sigmoid membership functions</td></tr> <tr><td><code>skfuzzy.membership.sigmf(x, b, c)</code></td> <td>The basic sigmoid membership function generator</td></tr> <tr><td><code>skfuzzy.membership.smf(x, a, b)</code></td> <td>S-function fuzzy membership generator</td></tr> <tr><td><code>skfuzzy.membership.trapmf(x, abcd)</code></td> <td>Trapezoidal membership function generator</td></tr> <tr><td><code>skfuzzy.membership.trimf(x, abc)</code></td> <td>Triangular membership function generator</td></tr> <tr><td><code>skfuzzy.membership.zmf(x, a, b)</code></td> <td>Z-function fuzzy membership generator</td></tr></tbody></table></li> <li><p>The fit vector of a linguitic value can be assigned to a linguistic variable using</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>speed<span class="token punctuation">[</span><span class="token string">'stopped'</span><span class="token punctuation">]</span> <span class="token operator">=</span> mf<span class="token punctuation">.</span>trimf<span class="token punctuation">(</span>speed<span class="token punctuation">.</span>universe<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
speed<span class="token punctuation">[</span><span class="token string">'very slow'</span><span class="token punctuation">]</span> <span class="token operator">=</span> mf<span class="token punctuation">.</span>trimf<span class="token punctuation">(</span>speed<span class="token punctuation">.</span>universe<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>Task</strong>: Assign all fuzzy sets to the linguistic variables.</p></li> <li><p>The fuzzy set diagram of a linguistic variable can be viewed using <code>.view()</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>speed<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>Task</strong>: Check if the fuzzy set diagrams match the fit vectors.</p></li></ol> <h4 id="define-rules"><a href="#define-rules" aria-hidden="true" class="header-anchor">#</a> Define rules</h4> <ol><li><p>The rules for this system are displayed in the following fuzzy association memory (FAM) representaion table.</p> <div style="overflow:auto;"><table style="width:1250px;text-align:center;"><tr><td colspan="2"></td> <td colspan="5">Distance</td></tr> <tr><td colspan="2"></td> <td style="width:200px;">At</td> <td style="width:200px;">Very near</td> <td style="width:200px;">Near</td> <td style="width:200px;">Medium far</td> <td style="width:200px;">Far</td></tr> <tr><td rowspan="5" style="width:100px;">Speed</td> <td style="width:150px;">Stopped</td> <td>Full brake<br>No throttle</td> <td>Full brake<br>Very slight throttle</td> <td></td> <td></td> <td></td></tr> <tr><td>Very slow</td> <td>Full brake<br>No throttle</td> <td>Medium brake<br>Very slight throttle</td> <td>Slight brake<br>Very slight throttle</td> <td></td> <td></td></tr> <tr><td>Slow</td> <td>Full brake<br>No throttle</td> <td>Medium brake<br>Very slight throttle</td> <td>Very slight brake<br>Slight throttle</td> <td></td> <td></td></tr> <tr><td>Medium fast</td> <td></td> <td></td> <td></td> <td>Very slight brake<br>Medium throttle</td> <td>No brake<br>Full throttle</td></tr> <tr><td>Fast</td> <td></td> <td></td> <td></td> <td>Very slight brake<br>Medium throttle</td> <td>No brake<br>Full throttle</td></tr></table></div></li> <li><p>Rule can be defined using <code>skfuzzy.control.Rule(antecedent, consequent, label)</code>. To define the first rule, i.e. if distance is 'at' and speed is 'stopped', then full brake and no throttle,</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>rule1 <span class="token operator">=</span> ctrl<span class="token punctuation">.</span>Rule<span class="token punctuation">(</span>distance<span class="token punctuation">[</span><span class="token string">'at'</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> speed<span class="token punctuation">[</span><span class="token string">'stopped'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>brake<span class="token punctuation">[</span><span class="token string">'full'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> throttle<span class="token punctuation">[</span><span class="token string">'no'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>If the antecedent consists of multiple parts, they can be combined using operators <code>|</code> (OR), <code>&amp;</code> (AND), and <code>~</code> (NOT).</p> <p>If the consequent consists of multiple parts, they can be combined as a <code>list</code>/<code>tuple</code>.</p> <p><strong>Task</strong>: Define all the rules. Then combine all the rules in a <code>list</code>, i.e. <code>rules = [rule1, rule2, ...]</code>.</p></li></ol> <h4 id="construct-the-fuzzy-control-system"><a href="#construct-the-fuzzy-control-system" aria-hidden="true" class="header-anchor">#</a> Construct the fuzzy control system</h4> <ol><li><p>The train control system can be constructed with</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>train_ctrl <span class="token operator">=</span> ctrl<span class="token punctuation">.</span>ControlSystem<span class="token punctuation">(</span>rules<span class="token operator">=</span>rules<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>A <code>skfuzzy.control.ControlSystemSimulation</code> object is needed to simulate the control system to obtain the outputs given certain inputs.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>train <span class="token operator">=</span> ctrl<span class="token punctuation">.</span>ControlSystemSimulation<span class="token punctuation">(</span>control_system<span class="token operator">=</span>train_ctrl<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>To obtain the values for <code>brake</code> and <code>throttle</code> given that <code>speed</code> is 30 km/h and <code>distance</code> is 6 m,</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># define the values for the inputs</span>
train<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">[</span><span class="token string">'speed'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">30</span>
train<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">[</span><span class="token string">'distance'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2000</span>

<span class="token comment"># compute the outputs</span>
train<span class="token punctuation">.</span>compute<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># print the output values</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>output<span class="token punctuation">)</span>

<span class="token comment"># to extract one of the outputs</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>output<span class="token punctuation">[</span><span class="token string">'brake'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>To view the results in the graph,</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>brake<span class="token punctuation">.</span>view<span class="token punctuation">(</span>sim<span class="token operator">=</span>train<span class="token punctuation">)</span>
throttle<span class="token punctuation">.</span>view<span class="token punctuation">(</span>sim<span class="token operator">=</span>train<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol> <h4 id="view-the-control-output-space"><a href="#view-the-control-output-space" aria-hidden="true" class="header-anchor">#</a> View the control/output space</h4> <ol><li><p>The control/output space allows us to identify if the outputs fit our expectation.</p></li> <li><p>Construct an empty 3D space with 100-by-100 x-y grid.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>x<span class="token punctuation">,</span> y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>speed<span class="token punctuation">.</span>universe<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> speed<span class="token punctuation">.</span>universe<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>distance<span class="token punctuation">.</span>universe<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> distance<span class="token punctuation">.</span>universe<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
z_brake <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>x<span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">)</span>
z_throttle <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>x<span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>Loop through every point and identify the value of brake and throttle of each point. As the specified rules are not exhaustive, i.e. some input combinations do not activate any rule, we will set the output of such input combinations to be <code>float('inf')</code>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">for</span> i<span class="token punctuation">,</span>r <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">for</span> j<span class="token punctuation">,</span>c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">:</span>
    train<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">[</span><span class="token string">'speed'</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span>
    train<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">[</span><span class="token string">'distance'</span><span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
      train<span class="token punctuation">.</span>compute<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
      z_brake<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'inf'</span><span class="token punctuation">)</span>
      z_throttle<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'inf'</span><span class="token punctuation">)</span>
    z_brake<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> train<span class="token punctuation">.</span>output<span class="token punctuation">[</span><span class="token string">'brake'</span><span class="token punctuation">]</span>
    z_throttle<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> train<span class="token punctuation">.</span>output<span class="token punctuation">[</span><span class="token string">'throttle'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>Plot the result in a 3D graph using the <code>matplotlib.pyplot</code> library.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> mpl_toolkits<span class="token punctuation">.</span>mplot3d <span class="token keyword">import</span> Axes3D

<span class="token keyword">def</span> <span class="token function">plot3d</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span>
  fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
  ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">,</span> projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>

  ax<span class="token punctuation">.</span>plot_surface<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> rstride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> cstride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'viridis'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span> antialiased<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

  ax<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> zdir<span class="token operator">=</span><span class="token string">'z'</span><span class="token punctuation">,</span> offset<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2.5</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'viridis'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
  ax<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> zdir<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">,</span> offset<span class="token operator">=</span>x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.5</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'viridis'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
  ax<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> zdir<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">,</span> offset<span class="token operator">=</span>y<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.5</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'viridis'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>

  ax<span class="token punctuation">.</span>view_init<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>

plot3d<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z_brake<span class="token punctuation">)</span>
plot3d<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z_throttle<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ol> <h3 id="fuzzy-tipping-recommendation-system"><a href="#fuzzy-tipping-recommendation-system" aria-hidden="true" class="header-anchor">#</a> Fuzzy tipping recommendation system</h3> <ol><li><p>A fuzzy expert system is designed to identify the percentage of tips a customer will give based on the service and the food the customer received.</p></li> <li><p>The system has service and food as inputs, and tips as output.</p></li> <li><p>The fit vectors of the fuzzy sets for the linguistic variables are given as follows:</p> <ul><li><p>service (0 to 10)</p> <table><thead><tr><th>Linguistic value</th> <th>Fit vector</th></tr></thead> <tbody><tr><td>Poor</td> <td>(1/0, 0/5)</td></tr> <tr><td>Average</td> <td>(0/0, 1/5, 0/10)</td></tr> <tr><td>Good</td> <td>(0/5, 1/10)</td></tr></tbody></table></li> <li><p>food (0 to 10)</p> <table><thead><tr><th>Linguistic value</th> <th>Fit vector</th></tr></thead> <tbody><tr><td>Poor</td> <td>(1/0, 0/5)</td></tr> <tr><td>Average</td> <td>(0/0, 1/5, 0/10)</td></tr> <tr><td>Good</td> <td>(0/5, 1/10)</td></tr></tbody></table></li> <li><p>tips (0 to 30%)</p> <table><thead><tr><th>Linguistic value</th> <th>Fit vector</th></tr></thead> <tbody><tr><td>Low</td> <td>(1/0, 0/15)</td></tr> <tr><td>Medium</td> <td>(0/0, 1/15, 0/30)</td></tr> <tr><td>High</td> <td>(0/15, 1/30)</td></tr></tbody></table></li></ul></li> <li><p>The rules are displayed in the following fuzzy association memory (FAM) representaion table.</p> <div style="overflow:auto;"><table style="width:850px;text-align:center;"><tr><td colspan="2"></td> <td colspan="3">Food</td></tr> <tr><td colspan="2"></td> <td style="width:200px;">Poor</td> <td style="width:200px;">Average</td> <td style="width:200px;">Good</td></tr> <tr><td rowspan="3" style="width:100px;">Service</td> <td style="width:150px;">Poor</td> <td>low tips</td> <td>low tips</td> <td>medium tips</td></tr> <tr><td>Average</td> <td>low tips</td> <td>medium tips</td> <td>high tips</td></tr> <tr><td>Good</td> <td>medium tips</td> <td>high tips</td> <td>high tips</td></tr></table></div></li></ol> <div style="margin-top:20px;"></div> <p><strong>Task</strong>: Construct the fuzzy inference system.</p> <div style="margin-top:20px;"></div> <p><strong>Task</strong>: Modify the membership functions of the input 'service' to</p> <table><thead><tr><th>Linguistic value</th> <th>Fit vector</th></tr></thead> <tbody><tr><td>Poor</td> <td>(1/0, 0/3)</td></tr> <tr><td>Average</td> <td>(0/2, 1/5, 0/8)</td></tr> <tr><td>Good</td> <td>(0/6, 1/10)</td></tr></tbody></table></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/23/2020, 1:04:14 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ‚Üê
        <a href="/ci-labs/archive/201908/lab6.html" class="prev">
          Lab 6: ANN (Hyperplane)
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/ci-labs/assets/js/app.5a6eedcf.js" defer></script><script src="/ci-labs/assets/js/2.f123190f.js" defer></script><script src="/ci-labs/assets/js/12.81161026.js" defer></script>
  </body>
</html>
